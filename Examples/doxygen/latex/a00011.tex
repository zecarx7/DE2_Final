\hypertarget{a00011}{}\doxysubsection{twi.\+h File Reference}
\label{a00011}\index{twi.h@{twi.h}}
{\ttfamily \#include $<$avr/io.\+h$>$}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{a00011_a762c164f4acd04d3ce3627fe73e7c018}{T\+W\+I\+\_\+\+P\+O\+RT}}~P\+O\+R\+TC
\item 
\#define \mbox{\hyperlink{a00011_a3f14ed8491293d0dda1372cceaa39851}{T\+W\+I\+\_\+\+S\+D\+A\+\_\+\+P\+IN}}~4
\item 
\#define \mbox{\hyperlink{a00011_ac0ad8b33f1be48e211f1eeae2dd65cee}{T\+W\+I\+\_\+\+S\+C\+L\+\_\+\+P\+IN}}~5
\item 
\#define \mbox{\hyperlink{a00011_a7a1c522bed64982971384489ee477bd3}{F\+\_\+\+S\+CL}}~50000
\item 
\#define \mbox{\hyperlink{a00011_a801c158406ca2334b446e442a2debe37}{T\+W\+I\+\_\+\+B\+I\+T\+\_\+\+R\+A\+T\+E\+\_\+\+R\+EG}}~((F\+\_\+\+C\+PU/\mbox{\hyperlink{a00011_a7a1c522bed64982971384489ee477bd3}{F\+\_\+\+S\+CL}} -\/ 16) / 2)
\item 
\#define \mbox{\hyperlink{a00011_aaf9a8abccd811954f9cc316f2b2f87b3}{T\+W\+I\+\_\+\+R\+E\+AD}}~1
\item 
\#define \mbox{\hyperlink{a00011_a3b68e8e777b71520f9dbfac733774d5f}{T\+W\+I\+\_\+\+W\+R\+I\+TE}}~0
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{a00011_a16f0e6b2fa5a26eadbf4086ab6d54467}{twi\+\_\+init}} (void)
\item 
uint8\+\_\+t \mbox{\hyperlink{a00011_a36b3c950a1804f75057a870afdf81d55}{twi\+\_\+start}} (uint8\+\_\+t slave\+\_\+address)
\item 
void \mbox{\hyperlink{a00011_ab45679e1a7b3b8f97b636d825e7d14f7}{twi\+\_\+write}} (uint8\+\_\+t data)
\item 
uint8\+\_\+t \mbox{\hyperlink{a00011_a7a2cd23dea30ee2c99c1ccffb3402d79}{twi\+\_\+read\+\_\+ack}} (void)
\item 
uint8\+\_\+t \mbox{\hyperlink{a00011_aa21e972557bab9a799720874660cf152}{twi\+\_\+read\+\_\+nack}} (void)
\item 
void \mbox{\hyperlink{a00011_acf52d6c93df110dee6d402b389e5042e}{twi\+\_\+stop}} (void)
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
T\+WI library for A\+V\+R-\/\+G\+CC.

The library defines functions for the T\+WI (I2C) communication between A\+VR and slave device(s). Functions use T\+WI module of A\+VR.

\begin{DoxyNote}{Note}
Based on Microchip Atmel A\+Tmega16 and A\+Tmega328P manuals.
\end{DoxyNote}
\begin{DoxyCopyright}{Copyright}
(c) 2018-\/2019 Tomas Fryza Dept. of Radio Electronics, Brno University of Technology, Czechia This work is licensed under the terms of the M\+IT license. 
\end{DoxyCopyright}


\doxysubsubsection{Macro Definition Documentation}
\mbox{\Hypertarget{a00011_a7a1c522bed64982971384489ee477bd3}\label{a00011_a7a1c522bed64982971384489ee477bd3}} 
\index{twi.h@{twi.h}!F\_SCL@{F\_SCL}}
\index{F\_SCL@{F\_SCL}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{F\_SCL}{F\_SCL}}
{\footnotesize\ttfamily \#define F\+\_\+\+S\+CL~50000}

T\+WI bit rate. \begin{DoxyWarning}{Warning}
Must be greater than 31000 kbps. 
\end{DoxyWarning}
\mbox{\Hypertarget{a00011_a801c158406ca2334b446e442a2debe37}\label{a00011_a801c158406ca2334b446e442a2debe37}} 
\index{twi.h@{twi.h}!TWI\_BIT\_RATE\_REG@{TWI\_BIT\_RATE\_REG}}
\index{TWI\_BIT\_RATE\_REG@{TWI\_BIT\_RATE\_REG}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{TWI\_BIT\_RATE\_REG}{TWI\_BIT\_RATE\_REG}}
{\footnotesize\ttfamily \#define T\+W\+I\+\_\+\+B\+I\+T\+\_\+\+R\+A\+T\+E\+\_\+\+R\+EG~((F\+\_\+\+C\+PU/\mbox{\hyperlink{a00011_a7a1c522bed64982971384489ee477bd3}{F\+\_\+\+S\+CL}} -\/ 16) / 2)}

T\+WI bit rate register value. \mbox{\Hypertarget{a00011_a762c164f4acd04d3ce3627fe73e7c018}\label{a00011_a762c164f4acd04d3ce3627fe73e7c018}} 
\index{twi.h@{twi.h}!TWI\_PORT@{TWI\_PORT}}
\index{TWI\_PORT@{TWI\_PORT}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{TWI\_PORT}{TWI\_PORT}}
{\footnotesize\ttfamily \#define T\+W\+I\+\_\+\+P\+O\+RT~P\+O\+R\+TC}

Port of T\+WI hardware unit. \mbox{\Hypertarget{a00011_aaf9a8abccd811954f9cc316f2b2f87b3}\label{a00011_aaf9a8abccd811954f9cc316f2b2f87b3}} 
\index{twi.h@{twi.h}!TWI\_READ@{TWI\_READ}}
\index{TWI\_READ@{TWI\_READ}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{TWI\_READ}{TWI\_READ}}
{\footnotesize\ttfamily \#define T\+W\+I\+\_\+\+R\+E\+AD~1}

Data direction for reading from T\+WI device. \mbox{\Hypertarget{a00011_ac0ad8b33f1be48e211f1eeae2dd65cee}\label{a00011_ac0ad8b33f1be48e211f1eeae2dd65cee}} 
\index{twi.h@{twi.h}!TWI\_SCL\_PIN@{TWI\_SCL\_PIN}}
\index{TWI\_SCL\_PIN@{TWI\_SCL\_PIN}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{TWI\_SCL\_PIN}{TWI\_SCL\_PIN}}
{\footnotesize\ttfamily \#define T\+W\+I\+\_\+\+S\+C\+L\+\_\+\+P\+IN~5}

S\+CL pin of T\+WI hardware unit. \mbox{\Hypertarget{a00011_a3f14ed8491293d0dda1372cceaa39851}\label{a00011_a3f14ed8491293d0dda1372cceaa39851}} 
\index{twi.h@{twi.h}!TWI\_SDA\_PIN@{TWI\_SDA\_PIN}}
\index{TWI\_SDA\_PIN@{TWI\_SDA\_PIN}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{TWI\_SDA\_PIN}{TWI\_SDA\_PIN}}
{\footnotesize\ttfamily \#define T\+W\+I\+\_\+\+S\+D\+A\+\_\+\+P\+IN~4}

S\+DA pin of T\+WI hardware unit. \mbox{\Hypertarget{a00011_a3b68e8e777b71520f9dbfac733774d5f}\label{a00011_a3b68e8e777b71520f9dbfac733774d5f}} 
\index{twi.h@{twi.h}!TWI\_WRITE@{TWI\_WRITE}}
\index{TWI\_WRITE@{TWI\_WRITE}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{TWI\_WRITE}{TWI\_WRITE}}
{\footnotesize\ttfamily \#define T\+W\+I\+\_\+\+W\+R\+I\+TE~0}

Data direction for writing to T\+WI device. 

\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{a00011_a16f0e6b2fa5a26eadbf4086ab6d54467}\label{a00011_a16f0e6b2fa5a26eadbf4086ab6d54467}} 
\index{twi.h@{twi.h}!twi\_init@{twi\_init}}
\index{twi\_init@{twi\_init}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{twi\_init()}{twi\_init()}}
{\footnotesize\ttfamily void twi\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Initialize T\+WI, enable internal pull-\/up resistors, and set S\+CL frequency. \begin{DoxyParagraph}{Implementation notes\+:}

\begin{DoxyItemize}
\item A\+VR internal pull-\/up resistors at pins T\+W\+I\+\_\+\+S\+D\+A\+\_\+\+P\+IN and T\+W\+I\+\_\+\+S\+C\+L\+\_\+\+P\+IN are enabled
\item T\+WI bit rate register value is calculated as follows fscl = fcpu/(16 + 2$\ast$\+T\+W\+BR) 
\end{DoxyItemize}
\end{DoxyParagraph}
\mbox{\Hypertarget{a00011_a7a2cd23dea30ee2c99c1ccffb3402d79}\label{a00011_a7a2cd23dea30ee2c99c1ccffb3402d79}} 
\index{twi.h@{twi.h}!twi\_read\_ack@{twi\_read\_ack}}
\index{twi\_read\_ack@{twi\_read\_ack}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{twi\_read\_ack()}{twi\_read\_ack()}}
{\footnotesize\ttfamily uint8\+\_\+t twi\+\_\+read\+\_\+ack (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Read one byte from T\+WI slave device, followed by A\+CK. \begin{DoxyReturn}{Returns}
Received data. 
\end{DoxyReturn}
\mbox{\Hypertarget{a00011_aa21e972557bab9a799720874660cf152}\label{a00011_aa21e972557bab9a799720874660cf152}} 
\index{twi.h@{twi.h}!twi\_read\_nack@{twi\_read\_nack}}
\index{twi\_read\_nack@{twi\_read\_nack}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{twi\_read\_nack()}{twi\_read\_nack()}}
{\footnotesize\ttfamily uint8\+\_\+t twi\+\_\+read\+\_\+nack (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Read one byte from T\+WI slave device, followed by N\+A\+CK. \begin{DoxyReturn}{Returns}
Received data. 
\end{DoxyReturn}
\mbox{\Hypertarget{a00011_a36b3c950a1804f75057a870afdf81d55}\label{a00011_a36b3c950a1804f75057a870afdf81d55}} 
\index{twi.h@{twi.h}!twi\_start@{twi\_start}}
\index{twi\_start@{twi\_start}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{twi\_start()}{twi\_start()}}
{\footnotesize\ttfamily uint8\+\_\+t twi\+\_\+start (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{slave\+\_\+address }\end{DoxyParamCaption})}

Start communication on T\+WI bus and send address of T\+WI slave. 
\begin{DoxyParams}{Parameters}
{\em slave\+\_\+address} & Address and transfer direction of T\+WI slave. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & -\/ Slave device accessible. \\
\hline
{\em 1} & -\/ Failed to access slave device. \\
\hline
\end{DoxyRetVals}
\begin{DoxyNote}{Note}
Function returns 0 only if 0x18 or 0x40 status code is detected. 0x18\+: S\+L\+A+W has been transmitted and A\+CK has been received. 0x40\+: S\+L\+A+R has been transmitted and A\+CK has been received. 
\end{DoxyNote}
\mbox{\Hypertarget{a00011_acf52d6c93df110dee6d402b389e5042e}\label{a00011_acf52d6c93df110dee6d402b389e5042e}} 
\index{twi.h@{twi.h}!twi\_stop@{twi\_stop}}
\index{twi\_stop@{twi\_stop}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{twi\_stop()}{twi\_stop()}}
{\footnotesize\ttfamily void twi\+\_\+stop (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Generates stop condition on T\+WI bus. \mbox{\Hypertarget{a00011_ab45679e1a7b3b8f97b636d825e7d14f7}\label{a00011_ab45679e1a7b3b8f97b636d825e7d14f7}} 
\index{twi.h@{twi.h}!twi\_write@{twi\_write}}
\index{twi\_write@{twi\_write}!twi.h@{twi.h}}
\doxyparagraph{\texorpdfstring{twi\_write()}{twi\_write()}}
{\footnotesize\ttfamily void twi\+\_\+write (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{data }\end{DoxyParamCaption})}

Send one byte to T\+WI slave device. 
\begin{DoxyParams}{Parameters}
{\em data} & Byte to be transmitted. \\
\hline
\end{DoxyParams}
